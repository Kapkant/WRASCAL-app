import{g as Y,s as $}from"./searchResultStore-b553b5b5.js";import{p as S,W as E,X as Z,Y as z,h as J,k as T,Z as K,s as G,$ as y,a0 as F,a1 as C,C as M,a as t,a2 as N,a3 as Q,a4 as ee,a5 as j,a6 as ae,a7 as te,a8 as w,a9 as ne,aa as O,ab as se,ac as U,ad as le,ae as oe,f as ie,af as re,ag as de,v as ce,ah as ue,d as pe,R as ve,_ as he,o as c,c as V,w as l,O as k,P as d,ai as fe,N as i,T as h,Q as ge,aj as m,ak as B,al as D,U as me,am as R,an as _e,ao as xe,ap as ye,aq as I,ar as A,as as Ve,at as ke}from"./index-cd4b0cfe.js";import{M as Ce,k as Pe,E as be}from"./ElementDisplayUtils-cc25b081.js";import{V as Se,a as Ee}from"./VCol-27c66ccd.js";import{V as Te,a as Me,b as De}from"./VCard-76543131.js";import{V as H}from"./VAlert-cce882e8.js";const P=Symbol.for("vuetify:v-expansion-panel"),Re=["default","accordion","inset","popout"],Ie=S({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>Re.includes(e)},readonly:Boolean,...E(),...Z(),...z(),...J()},"VExpansionPanels"),Le=T()({name:"VExpansionPanels",props:Ie(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:n}=a;K(e,P);const{themeClasses:s}=G(e),f=y(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return F({VExpansionPanel:{color:C(e,"color"),readonly:C(e,"readonly"),static:C(e,"static")}}),M(()=>t(e.tag,{class:["v-expansion-panels",s.value,f.value,e.class],style:e.style},n)),{}}}),$e=S({...E(),...N()},"VExpansionPanelText"),W=T()({name:"VExpansionPanelText",props:$e(),setup(e,a){let{slots:n}=a;const s=Q(P);if(!s)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:f,onAfterLeave:x}=ee(e,s.isSelected);return M(()=>t(te,{onAfterLeave:x},{default:()=>{var v;return[j(t("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&f.value&&t("div",{class:"v-expansion-panel-text__wrapper"},[(v=n.default)==null?void 0:v.call(n)])]),[[ae,s.isSelected.value]])]}})),{}}}),q=S({color:String,expandIcon:{type:w,default:"$expand"},collapseIcon:{type:w,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...E()},"VExpansionPanelTitle"),X=T()({name:"VExpansionPanelTitle",directives:{Ripple:ne},props:q(),setup(e,a){let{slots:n}=a;const s=Q(P);if(!s)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:f,backgroundColorStyles:x}=O(e,"color"),v=y(()=>({collapseIcon:e.collapseIcon,disabled:s.disabled.value,expanded:s.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return M(()=>{var _;return j(t("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":s.isSelected.value,"v-expansion-panel-title--static":e.static},f.value,e.class],style:[x.value,e.style],type:"button",tabindex:s.disabled.value?-1:void 0,disabled:s.disabled.value,"aria-expanded":s.isSelected.value,onClick:e.readonly?void 0:s.toggle},[t("span",{class:"v-expansion-panel-title__overlay"},null),(_=n.default)==null?void 0:_.call(n,v.value),!e.hideActions&&t("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(v.value):t(U,{icon:s.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[se("ripple"),e.ripple]])}),{}}}),we=S({title:String,text:String,bgColor:String,...E(),...le(),...oe(),...N(),...ie(),...z(),...q()},"VExpansionPanel"),Be=T()({name:"VExpansionPanel",props:we(),emits:{"group:selected":e=>!0},setup(e,a){let{slots:n}=a;const s=re(e,P),{backgroundColorClasses:f,backgroundColorStyles:x}=O(e,"bgColor"),{elevationClasses:v}=de(e),{roundedClasses:_}=ce(e),u=y(()=>(s==null?void 0:s.disabled.value)||e.disabled),r=y(()=>s.group.items.value.reduce((g,p,b)=>(s.group.selected.value.includes(p.id)&&g.push(b),g),[])),o=y(()=>{const g=s.group.items.value.findIndex(p=>p.id===s.id);return!s.isSelected.value&&r.value.some(p=>p-g===1)}),L=y(()=>{const g=s.group.items.value.findIndex(p=>p.id===s.id);return!s.isSelected.value&&r.value.some(p=>p-g===-1)});return ue(P,s),F({VExpansionPanelText:{eager:C(e,"eager")},VExpansionPanelTitle:{readonly:C(e,"readonly")}}),M(()=>{const g=!!(n.text||e.text),p=!!(n.title||e.title);return t(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":s.isSelected.value,"v-expansion-panel--before-active":o.value,"v-expansion-panel--after-active":L.value,"v-expansion-panel--disabled":u.value},_.value,f.value,e.class],style:[x.value,e.style]},{default:()=>{var b;return[t("div",{class:["v-expansion-panel__shadow",...v.value]},null),p&&t(X,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),g&&t(W,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(b=n.default)==null?void 0:b.call(n)]}})}),{}}}),Ae=pe({name:"SearchResult",setup:()=>{ve({title:"Search Results"})},data:()=>({searchResult:[],lastQuery:"",constantsData:{},loadingConstants:{},openedMetalKeys:[],constantHeaders:[{title:"Expression",align:"start",key:"expression_string"},{title:"Constant Kind",align:"end",key:"constant_kind"},{title:"Temp (Â°C)",align:"end",key:"temperature"},{title:"Ionic Strength (M)",align:"center",key:"ionic_strength"},{title:"Value",align:"start",key:"value"},{title:"Actions",key:"data-table-expand"}]}),computed:{groupedByLigand(){const e={};for(const a of this.searchResult)e[a.name]||(e[a.name]=[]),e[a.name].push(a);return e}},methods:{returnToSearchPage(){this.$router.go(-1)},groupMetalsByLigand(e){const a={};for(const n of e){const s=`${n.central_element}_${n.metal_id}_${n.ligand_id}`;a[s]||(a[s]=[]),a[s].push(n)}return a},toggleMetalPanel(e,a){console.log("toggleMetalPanel called",e,"current openedMetalKeys:",this.openedMetalKeys);const n=this.openedMetalKeys.indexOf(e);n>-1?(this.openedMetalKeys.splice(n,1),console.log("Removed from openedMetalKeys:",this.openedMetalKeys)):(this.openedMetalKeys.push(e),console.log("Added to openedMetalKeys:",this.openedMetalKeys),a&&a.length>0&&!this.constantsData[e]&&!this.loadingConstants[e]&&(console.log("Loading constants for",e),this.loadConstants(a[0])))},async loadConstants(e){const a=`${e.central_element}_${e.metal_id}_${e.ligand_id}`;if(!this.constantsData[a]){this.loadingConstants[a]=!0;try{const n=await Y(e.ligand_id,e.metal_id);n?this.constantsData[a]=n:this.constantsData[a]=[]}catch(n){console.error("Error loading constants:",n),this.constantsData[a]=[]}finally{this.loadingConstants[a]=!1}}},goToDetailPage(e){const a=$();a.selectedSearchResult=e,this.$router.push("/detail-view")},getFormattedMetalForm(e){if(!e)return"-";const a=Ce.formatMetalFormulaString(e);return Pe.renderToString(a,{displayMode:!1,throwOnError:!1})},formatCharge(e){return be.formatElementCharge(+e)},formatValue(e,a){return a!==void 0?e.toPrecision(a):e.toString()},highlightMatch(e){if(!this.lastQuery)return e;const a=new RegExp(`(${this.lastQuery})`,"ig");return e.replace(a,'<span class="mark">$1</span>')}},mounted(){const e=$();this.searchResult=e.searchResult,this.lastQuery=e.lastQuery}});const He=i("div",null,[i("div",{class:"d-flex text-overline mb-1"}," OVERVIEW "),i("div",{class:"d-flex text-h6 mb-1"}," Search Result "),i("div",{class:"d-flex text-caption text-left"}," Here you can view the current search results organized by ligand and metal. Expand each accordion to see the available data tables. ")],-1),ze={class:"text-caption mr-3"},Fe={class:"d-flex align-center"},Ne=["innerHTML"],Qe={class:"pa-2"},je={class:"d-flex align-center"},Oe={class:"text-subtitle-1 mr-3"},Ue=["innerHTML"],We=["innerHTML"],qe={key:0,class:"pa-4",style:{display:"block",border:"2px solid red"}},Xe={key:0,class:"text-center pa-4"},Ye=i("div",{class:"mt-2"},"Loading constants...",-1),Ze={key:1,class:"text-center pa-4"},Je=i("div",{class:"mt-2"},"Loading constants...",-1),Ke={key:2},Ge=["innerHTML"],ea={class:"mt-3"},aa={key:3,class:"text-center pa-4"},ta={class:"mt-3"};function na(e,a,n,s,f,x){return c(),V(Se,{class:"fill-height"},{default:l(()=>[t(me,{class:"d-flex text-center fill-height"},{default:l(()=>[t(Te,{class:"mx-auto",variant:"outlined"},{default:l(()=>[t(Me,null,{default:l(()=>[He]),_:1}),t(De,null,{default:l(()=>[t(k,{variant:"outlined","prepend-icon":"mdi-arrow-left",onClick:e.returnToSearchPage},{default:l(()=>[d(" Return To Search Page ")]),_:1},8,["onClick"]),t(fe),i("div",ze,h(e.searchResult.length)+" result(s)",1)]),_:1})]),_:1}),t(ge,{justify:"center",class:"pt-10"},{default:l(()=>[t(Ee,{cols:"12"},{default:l(()=>[e.searchResult.length===0?(c(),V(H,{key:0,type:"info",variant:"tonal",border:"start",class:"mb-6"},{default:l(()=>[d(" No results found. Try a different ligand name or adjust your filters. ")]),_:1})):(c(),V(Le,{key:1,variant:"accordion",multiple:""},{default:l(()=>[(c(!0),m(D,null,B(e.groupedByLigand,(v,_)=>(c(),V(Be,{key:_},{default:l(()=>[t(X,null,{default:l(()=>[i("div",Fe,[i("span",{innerHTML:e.highlightMatch(_),class:"text-h6 mr-3"},null,8,Ne),t(R,{size:"small",color:"primary",class:"mr-2"},{default:l(()=>[d(h(v.length)+" metal(s) ",1)]),_:2},1024)])]),_:2},1024),t(W,null,{default:l(()=>[i("div",Qe,[t(_e,null,{default:l(()=>[(c(!0),m(D,null,B(e.groupMetalsByLigand(v),(u,r)=>(c(),m(D,{key:r},[t(xe,null,{prepend:l(()=>[t(k,{icon:"",variant:"text",size:"small",onClick:o=>e.toggleMetalPanel(r,u)},{default:l(()=>[t(U,null,{default:l(()=>[d(h(e.openedMetalKeys.includes(r)?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:2},1024)]),_:2},1032,["onClick"])]),default:l(()=>[t(ye,null,{default:l(()=>[i("div",je,[i("span",Oe,[d(h(u[0].central_element),1),i("sup",{innerHTML:e.formatCharge(u[0].metal_charge)},null,8,Ue)]),t(R,{size:"small",color:"secondary",class:"mr-2"},{default:l(()=>[d(h(u.length)+" entry/entries ",1)]),_:2},1024),u[0].formula_string?(c(),V(R,{key:0,size:"small",color:"info"},{default:l(()=>[i("div",{class:"no-katex-html",innerHTML:e.getFormattedMetalForm(u[0].formula_string)},null,8,We)]),_:2},1024)):I("",!0)])]),_:2},1024)]),_:2},1024),e.openedMetalKeys.includes(r)?(c(),m("div",qe,[i("div",null,"DEBUG: Content should be visible for "+h(r),1),e.loadingConstants[r]?(c(),m("div",Xe,[t(A,{indeterminate:"",color:"primary"}),Ye])):e.constantsData[r]?e.constantsData[r]&&e.constantsData[r].length>0?(c(),m("div",Ke,[t(Ve,{headers:e.constantHeaders,items:e.constantsData[r],"items-per-page":20,class:"elevation-1"},{"item.expression_string":l(({item:o})=>[i("div",{innerHTML:o.expression_string||"-"},null,8,Ge)]),"item.constant_kind":l(({item:o})=>[d(h(o.constant_kind||"-"),1)]),"item.temperature":l(({item:o})=>[d(h(o.temperature!==void 0?o.temperature+(o.temperature_varies?" (varies)":""):"-"),1)]),"item.ionic_strength":l(({item:o})=>[d(h(o.ionic_strength!==void 0?o.ionic_strength:"-"),1)]),"item.value":l(({item:o})=>[d(h(o.value!==void 0?e.formatValue(o.value,o.significant_figures):"-"),1)]),"item.data-table-expand":l(({item:o})=>[t(k,{size:"small",variant:"text",onClick:L=>e.goToDetailPage(u[0])},{default:l(()=>[d(" View Details ")]),_:2},1032,["onClick"])]),_:2},1032,["headers","items"]),i("div",ea,[t(k,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(u[0])},{default:l(()=>[d(" View Full Details ")]),_:2},1032,["onClick"])])])):e.constantsData[r]&&e.constantsData[r].length===0?(c(),m("div",aa,[t(H,{type:"info",variant:"tonal"},{default:l(()=>[d(" No constants data available for this metal-ligand combination. ")]),_:1}),i("div",ta,[t(k,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(u[0])},{default:l(()=>[d(" View Detail Page ")]),_:2},1032,["onClick"])])])):I("",!0):(c(),m("div",Ze,[t(A,{indeterminate:"",color:"primary"}),Je]))])):I("",!0),t(ke,{class:"my-2"})],64))),128))]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}const ca=he(Ae,[["render",na]]);export{ca as default};
