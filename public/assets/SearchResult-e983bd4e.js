import{g as Z,s as I}from"./searchResultStore-97367c97.js";import{p as S,W as E,X as q,Y as j,h as J,k as T,Z as K,s as G,$ as y,a0 as N,a1 as k,C as D,a as s,a2 as Q,a3 as O,a4 as ee,a5 as W,a6 as ae,a7 as te,a8 as B,a9 as ne,aa as X,ab as se,ac as le,ad as oe,ae as ie,f as re,af as de,ag as ce,v as ue,ah as pe,d as ve,R as fe,_ as he,o as v,c as _,w as l,O as b,P as d,ai as me,N as i,T as g,Q as ge,aj as V,ak as L,al as H,U as xe,am as M,an as A,ao as _e,ap as ye}from"./index-46dd6a44.js";import{M as Ve,k as ke,E as Ce}from"./ElementDisplayUtils-cc25b081.js";import{V as Pe,a as be}from"./VCol-01252037.js";import{V as Se,a as Ee,b as Te}from"./VCard-1db52866.js";import{V as z}from"./VAlert-d6a80e27.js";const C=Symbol.for("vuetify:v-expansion-panel"),De=["default","accordion","inset","popout"],Re=S({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>De.includes(e)},readonly:Boolean,...E(),...q(),...j(),...J()},"VExpansionPanels"),F=T()({name:"VExpansionPanels",props:Re(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;K(e,C);const{themeClasses:a}=G(e),u=y(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return N({VExpansionPanel:{color:k(e,"color"),readonly:k(e,"readonly"),static:k(e,"static")}}),D(()=>s(e.tag,{class:["v-expansion-panels",a.value,u.value,e.class],style:e.style},n)),{}}}),Me=S({...E(),...Q()},"VExpansionPanelText"),$=T()({name:"VExpansionPanelText",props:Me(),setup(e,t){let{slots:n}=t;const a=O(C);if(!a)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:f}=ee(e,a.isSelected);return D(()=>s(te,{onAfterLeave:f},{default:()=>{var r;return[W(s("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&u.value&&s("div",{class:"v-expansion-panel-text__wrapper"},[(r=n.default)==null?void 0:r.call(n)])]),[[ae,a.isSelected.value]])]}})),{}}}),Y=S({color:String,expandIcon:{type:B,default:"$expand"},collapseIcon:{type:B,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...E()},"VExpansionPanelTitle"),w=T()({name:"VExpansionPanelTitle",directives:{Ripple:ne},props:Y(),setup(e,t){let{slots:n}=t;const a=O(C);if(!a)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:f}=X(e,"color"),r=y(()=>({collapseIcon:e.collapseIcon,disabled:a.disabled.value,expanded:a.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return D(()=>{var x;return W(s("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":a.isSelected.value,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[f.value,e.style],type:"button",tabindex:a.disabled.value?-1:void 0,disabled:a.disabled.value,"aria-expanded":a.isSelected.value,onClick:e.readonly?void 0:a.toggle},[s("span",{class:"v-expansion-panel-title__overlay"},null),(x=n.default)==null?void 0:x.call(n,r.value),!e.hideActions&&s("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(r.value):s(le,{icon:a.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[se("ripple"),e.ripple]])}),{}}}),$e=S({title:String,text:String,bgColor:String,...E(),...oe(),...ie(),...Q(),...re(),...j(),...Y()},"VExpansionPanel"),U=T()({name:"VExpansionPanel",props:$e(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const a=de(e,C),{backgroundColorClasses:u,backgroundColorStyles:f}=X(e,"bgColor"),{elevationClasses:r}=ce(e),{roundedClasses:x}=ue(e),c=y(()=>(a==null?void 0:a.disabled.value)||e.disabled),h=y(()=>a.group.items.value.reduce((m,p,P)=>(a.group.selected.value.includes(p.id)&&m.push(P),m),[])),R=y(()=>{const m=a.group.items.value.findIndex(p=>p.id===a.id);return!a.isSelected.value&&h.value.some(p=>p-m===1)}),o=y(()=>{const m=a.group.items.value.findIndex(p=>p.id===a.id);return!a.isSelected.value&&h.value.some(p=>p-m===-1)});return pe(C,a),N({VExpansionPanelText:{eager:k(e,"eager")},VExpansionPanelTitle:{readonly:k(e,"readonly")}}),D(()=>{const m=!!(n.text||e.text),p=!!(n.title||e.title);return s(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":a.isSelected.value,"v-expansion-panel--before-active":R.value,"v-expansion-panel--after-active":o.value,"v-expansion-panel--disabled":c.value},x.value,u.value,e.class],style:[f.value,e.style]},{default:()=>{var P;return[s("div",{class:["v-expansion-panel__shadow",...r.value]},null),p&&s(w,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),m&&s($,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(P=n.default)==null?void 0:P.call(n)]}})}),{}}}),we=ve({name:"SearchResult",setup:()=>{fe({title:"Search Results"})},data:()=>({searchResult:[],lastQuery:"",constantsData:{},loadingConstants:{},constantHeaders:[{title:"Expression",align:"start",key:"expression_string"},{title:"Constant Kind",align:"end",key:"constant_kind"},{title:"Temp (Â°C)",align:"end",key:"temperature"},{title:"Ionic Strength (M)",align:"center",key:"ionic_strength"},{title:"Value",align:"start",key:"value"},{title:"Actions",key:"data-table-expand"}]}),computed:{groupedByLigand(){const e={};for(const t of this.searchResult)e[t.name]||(e[t.name]=[]),e[t.name].push(t);return e}},methods:{returnToSearchPage(){this.$router.go(-1)},groupMetalsByLigand(e){const t={};for(const n of e){const a=`${n.central_element}_${n.metal_id}_${n.ligand_id}`;t[a]||(t[a]=[]),t[a].push(n)}return t},onMetalPanelUpdate(e,t){const n=this.groupMetalsByLigand(e),a=Object.keys(n);for(const u of t)if(u<a.length){const f=a[u],r=n[f];r&&r.length>0&&!this.constantsData[f]&&!this.loadingConstants[f]&&this.loadConstants(r[0])}},async loadConstants(e){const t=`${e.central_element}_${e.metal_id}_${e.ligand_id}`;if(!this.constantsData[t]){this.loadingConstants[t]=!0;try{const n=await Z(e.ligand_id,e.metal_id);n?this.constantsData[t]=n:this.constantsData[t]=[]}catch(n){console.error("Error loading constants:",n),this.constantsData[t]=[]}finally{this.loadingConstants[t]=!1}}},goToDetailPage(e){const t=I();t.selectedSearchResult=e,this.$router.push("/detail-view")},getFormattedMetalForm(e){if(!e)return"-";const t=Ve.formatMetalFormulaString(e);return ke.renderToString(t,{displayMode:!1,throwOnError:!1})},formatCharge(e){return Ce.formatElementCharge(+e)},formatValue(e,t){return t!==void 0?e.toPrecision(t):e.toString()},highlightMatch(e){if(!this.lastQuery)return e;const t=new RegExp(`(${this.lastQuery})`,"ig");return e.replace(t,'<span class="mark">$1</span>')}},mounted(){const e=I();this.searchResult=e.searchResult,this.lastQuery=e.lastQuery}});const Ie=i("div",null,[i("div",{class:"d-flex text-overline mb-1"}," OVERVIEW "),i("div",{class:"d-flex text-h6 mb-1"}," Search Result "),i("div",{class:"d-flex text-caption text-left"}," Here you can view the current search results organized by ligand and metal. Expand each accordion to see the available data tables. ")],-1),Be={class:"text-caption mr-3"},Le={class:"d-flex align-center"},He=["innerHTML"],Ae={class:"pa-2"},ze={class:"d-flex align-center"},Fe={class:"text-subtitle-1 mr-3"},Ue=["innerHTML"],je=["innerHTML"],Ne={key:0,class:"text-center pa-4"},Qe=i("div",{class:"mt-2"},"Loading constants...",-1),Oe={key:1},We=["innerHTML"],Xe={class:"mt-3"},Ye={key:2,class:"text-center pa-4"},Ze={class:"mt-3"};function qe(e,t,n,a,u,f){return v(),_(Pe,{class:"fill-height"},{default:l(()=>[s(xe,{class:"d-flex text-center fill-height"},{default:l(()=>[s(Se,{class:"mx-auto",variant:"outlined"},{default:l(()=>[s(Ee,null,{default:l(()=>[Ie]),_:1}),s(Te,null,{default:l(()=>[s(b,{variant:"outlined","prepend-icon":"mdi-arrow-left",onClick:e.returnToSearchPage},{default:l(()=>[d(" Return To Search Page ")]),_:1},8,["onClick"]),s(me),i("div",Be,g(e.searchResult.length)+" result(s)",1)]),_:1})]),_:1}),s(ge,{justify:"center",class:"pt-10"},{default:l(()=>[s(be,{cols:"12"},{default:l(()=>[e.searchResult.length===0?(v(),_(z,{key:0,type:"info",variant:"tonal",border:"start",class:"mb-6"},{default:l(()=>[d(" No results found. Try a different ligand name or adjust your filters. ")]),_:1})):(v(),_(F,{key:1,variant:"accordion",multiple:""},{default:l(()=>[(v(!0),V(H,null,L(e.groupedByLigand,(r,x)=>(v(),_(U,{key:x},{default:l(()=>[s(w,null,{default:l(()=>[i("div",Le,[i("span",{innerHTML:e.highlightMatch(x),class:"text-h6 mr-3"},null,8,He),s(M,{size:"small",color:"primary",class:"mr-2"},{default:l(()=>[d(g(r.length)+" metal(s) ",1)]),_:2},1024)])]),_:2},1024),s($,null,{default:l(()=>[i("div",Ae,[s(F,{variant:"accordion",multiple:"","onUpdate:modelValue":c=>e.onMetalPanelUpdate(r,c)},{default:l(()=>[(v(!0),V(H,null,L(e.groupMetalsByLigand(r),(c,h,R)=>(v(),_(U,{key:h,value:R},{default:l(()=>[s(w,null,{default:l(()=>[i("div",ze,[i("span",Fe,[d(g(c[0].central_element),1),i("sup",{innerHTML:e.formatCharge(c[0].metal_charge)},null,8,Ue)]),s(M,{size:"small",color:"secondary",class:"mr-2"},{default:l(()=>[d(g(c.length)+" entry/entries ",1)]),_:2},1024),c[0].formula_string?(v(),_(M,{key:0,size:"small",color:"info"},{default:l(()=>[i("div",{class:"no-katex-html",innerHTML:e.getFormattedMetalForm(c[0].formula_string)},null,8,je)]),_:2},1024)):A("",!0)])]),_:2},1024),s($,null,{default:l(()=>[e.loadingConstants[h]?(v(),V("div",Ne,[s(_e,{indeterminate:"",color:"primary"}),Qe])):e.constantsData[h]&&e.constantsData[h].length>0?(v(),V("div",Oe,[s(ye,{headers:e.constantHeaders,items:e.constantsData[h],"items-per-page":20,class:"elevation-1"},{"item.expression_string":l(({item:o})=>[i("div",{innerHTML:o.expression_string||"-"},null,8,We)]),"item.constant_kind":l(({item:o})=>[d(g(o.constant_kind||"-"),1)]),"item.temperature":l(({item:o})=>[d(g(o.temperature!==void 0?o.temperature+(o.temperature_varies?" (varies)":""):"-"),1)]),"item.ionic_strength":l(({item:o})=>[d(g(o.ionic_strength!==void 0?o.ionic_strength:"-"),1)]),"item.value":l(({item:o})=>[d(g(o.value!==void 0?e.formatValue(o.value,o.significant_figures):"-"),1)]),"item.data-table-expand":l(({item:o})=>[s(b,{size:"small",variant:"text",onClick:m=>e.goToDetailPage(c[0])},{default:l(()=>[d(" View Details ")]),_:2},1032,["onClick"])]),_:2},1032,["headers","items"]),i("div",Xe,[s(b,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(c[0])},{default:l(()=>[d(" View Full Details ")]),_:2},1032,["onClick"])])])):e.constantsData[h]&&e.constantsData[h].length===0?(v(),V("div",Ye,[s(z,{type:"info",variant:"tonal"},{default:l(()=>[d(" No constants data available for this metal-ligand combination. ")]),_:1}),i("div",Ze,[s(b,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(c[0])},{default:l(()=>[d(" View Detail Page ")]),_:2},1032,["onClick"])])])):A("",!0)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1032,["onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}const na=he(we,[["render",qe]]);export{na as default};
