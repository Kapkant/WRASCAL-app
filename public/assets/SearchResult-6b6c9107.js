import{g as q,s as I}from"./searchResultStore-537a9667.js";import{p as S,W as E,X as J,Y as N,h as K,k as T,Z as G,s as ee,$ as V,a0 as Q,a1 as k,C as D,a as s,a2 as O,a3 as W,a4 as ae,a5 as X,a6 as te,a7 as ne,a8 as L,a9 as se,aa as Y,ab as le,ac as oe,ad as ie,ae as re,f as de,af as ce,ag as ue,v as pe,ah as ve,d as fe,R as me,_ as he,o as u,c as x,w as l,O as b,P as c,ai as ge,N as i,T as g,Q as _e,aj as y,ak as B,al as H,U as xe,am as R,an as A,ao as z,ap as ye}from"./index-2f6ffadd.js";import{M as Ve,k as ke,E as Pe}from"./ElementDisplayUtils-cc25b081.js";import{V as Ce,a as be}from"./VCol-7e1d829d.js";import{V as Se,a as Ee,b as Te}from"./VCard-c126cb60.js";import{V as F}from"./VAlert-98c7319f.js";const P=Symbol.for("vuetify:v-expansion-panel"),De=["default","accordion","inset","popout"],Me=S({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>De.includes(e)},readonly:Boolean,...E(),...J(),...N(),...K()},"VExpansionPanels"),U=T()({name:"VExpansionPanels",props:Me(),emits:{"update:modelValue":e=>!0},setup(e,a){let{slots:n}=a;G(e,P);const{themeClasses:t}=ee(e),p=V(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return Q({VExpansionPanel:{color:k(e,"color"),readonly:k(e,"readonly"),static:k(e,"static")}}),D(()=>s(e.tag,{class:["v-expansion-panels",t.value,p.value,e.class],style:e.style},n)),{}}}),Re=S({...E(),...O()},"VExpansionPanelText"),$=T()({name:"VExpansionPanelText",props:Re(),setup(e,a){let{slots:n}=a;const t=W(P);if(!t)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:p,onAfterLeave:m}=ae(e,t.isSelected);return D(()=>s(ne,{onAfterLeave:m},{default:()=>{var r;return[X(s("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&p.value&&s("div",{class:"v-expansion-panel-text__wrapper"},[(r=n.default)==null?void 0:r.call(n)])]),[[te,t.isSelected.value]])]}})),{}}}),Z=S({color:String,expandIcon:{type:L,default:"$expand"},collapseIcon:{type:L,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...E()},"VExpansionPanelTitle"),w=T()({name:"VExpansionPanelTitle",directives:{Ripple:se},props:Z(),setup(e,a){let{slots:n}=a;const t=W(P);if(!t)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:p,backgroundColorStyles:m}=Y(e,"color"),r=V(()=>({collapseIcon:e.collapseIcon,disabled:t.disabled.value,expanded:t.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return D(()=>{var _;return X(s("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":t.isSelected.value,"v-expansion-panel-title--static":e.static},p.value,e.class],style:[m.value,e.style],type:"button",tabindex:t.disabled.value?-1:void 0,disabled:t.disabled.value,"aria-expanded":t.isSelected.value,onClick:e.readonly?void 0:t.toggle},[s("span",{class:"v-expansion-panel-title__overlay"},null),(_=n.default)==null?void 0:_.call(n,r.value),!e.hideActions&&s("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(r.value):s(oe,{icon:t.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[le("ripple"),e.ripple]])}),{}}}),$e=S({title:String,text:String,bgColor:String,...E(),...ie(),...re(),...O(),...de(),...N(),...Z()},"VExpansionPanel"),j=T()({name:"VExpansionPanel",props:$e(),emits:{"group:selected":e=>!0},setup(e,a){let{slots:n}=a;const t=ce(e,P),{backgroundColorClasses:p,backgroundColorStyles:m}=Y(e,"bgColor"),{elevationClasses:r}=ue(e),{roundedClasses:_}=pe(e),d=V(()=>(t==null?void 0:t.disabled.value)||e.disabled),v=V(()=>t.group.items.value.reduce((h,f,C)=>(t.group.selected.value.includes(f.id)&&h.push(C),h),[])),M=V(()=>{const h=t.group.items.value.findIndex(f=>f.id===t.id);return!t.isSelected.value&&v.value.some(f=>f-h===1)}),o=V(()=>{const h=t.group.items.value.findIndex(f=>f.id===t.id);return!t.isSelected.value&&v.value.some(f=>f-h===-1)});return ve(P,t),Q({VExpansionPanelText:{eager:k(e,"eager")},VExpansionPanelTitle:{readonly:k(e,"readonly")}}),D(()=>{const h=!!(n.text||e.text),f=!!(n.title||e.title);return s(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":t.isSelected.value,"v-expansion-panel--before-active":M.value,"v-expansion-panel--after-active":o.value,"v-expansion-panel--disabled":d.value},_.value,p.value,e.class],style:[m.value,e.style]},{default:()=>{var C;return[s("div",{class:["v-expansion-panel__shadow",...r.value]},null),f&&s(w,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),h&&s($,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(C=n.default)==null?void 0:C.call(n)]}})}),{}}}),we=fe({name:"SearchResult",setup:()=>{me({title:"Search Results"})},data:()=>({searchResult:[],lastQuery:"",constantsData:{},loadingConstants:{},openedMetalPanels:[],constantHeaders:[{title:"Expression",align:"start",key:"expression_string"},{title:"Constant Kind",align:"end",key:"constant_kind"},{title:"Temp (Â°C)",align:"end",key:"temperature"},{title:"Ionic Strength (M)",align:"center",key:"ionic_strength"},{title:"Value",align:"start",key:"value"},{title:"Actions",key:"data-table-expand"}]}),computed:{groupedByLigand(){const e={};for(const a of this.searchResult)e[a.name]||(e[a.name]=[]),e[a.name].push(a);return e}},methods:{returnToSearchPage(){this.$router.go(-1)},groupMetalsByLigand(e){const a={};for(const n of e){const t=`${n.central_element}_${n.metal_id}_${n.ligand_id}`;a[t]||(a[t]=[]),a[t].push(n)}return a},onMetalPanelUpdate(e,a){const n=this.groupMetalsByLigand(e),t=Object.keys(n);for(const p of a)if(p<t.length){const m=t[p],r=n[m];r&&r.length>0&&!this.constantsData[m]&&!this.loadingConstants[m]&&this.loadConstants(r[0])}},async loadConstants(e){const a=`${e.central_element}_${e.metal_id}_${e.ligand_id}`;if(!this.constantsData[a]){this.loadingConstants[a]=!0;try{const n=await q(e.ligand_id,e.metal_id);n?this.constantsData[a]=n:this.constantsData[a]=[]}catch(n){console.error("Error loading constants:",n),this.constantsData[a]=[]}finally{this.loadingConstants[a]=!1}}},goToDetailPage(e){const a=I();a.selectedSearchResult=e,this.$router.push("/detail-view")},getFormattedMetalForm(e){if(!e)return"-";const a=Ve.formatMetalFormulaString(e);return ke.renderToString(a,{displayMode:!1,throwOnError:!1})},formatCharge(e){return Pe.formatElementCharge(+e)},formatValue(e,a){return a!==void 0?e.toPrecision(a):e.toString()},highlightMatch(e){if(!this.lastQuery)return e;const a=new RegExp(`(${this.lastQuery})`,"ig");return e.replace(a,'<span class="mark">$1</span>')}},mounted(){const e=I();this.searchResult=e.searchResult,this.lastQuery=e.lastQuery}});const Ie=i("div",null,[i("div",{class:"d-flex text-overline mb-1"}," OVERVIEW "),i("div",{class:"d-flex text-h6 mb-1"}," Search Result "),i("div",{class:"d-flex text-caption text-left"}," Here you can view the current search results organized by ligand and metal. Expand each accordion to see the available data tables. ")],-1),Le={class:"text-caption mr-3"},Be={class:"d-flex align-center"},He=["innerHTML"],Ae={class:"pa-2"},ze={class:"d-flex align-center"},Fe={class:"text-subtitle-1 mr-3"},Ue=["innerHTML"],je=["innerHTML"],Ne={key:0,class:"text-center pa-4"},Qe=i("div",{class:"mt-2"},"Loading constants...",-1),Oe={key:1,class:"text-center pa-4"},We=i("div",{class:"mt-2"},"Loading constants...",-1),Xe={key:2},Ye=["innerHTML"],Ze={class:"mt-3"},qe={key:3,class:"text-center pa-4"},Je={class:"mt-3"};function Ke(e,a,n,t,p,m){return u(),x(Ce,{class:"fill-height"},{default:l(()=>[s(xe,{class:"d-flex text-center fill-height"},{default:l(()=>[s(Se,{class:"mx-auto",variant:"outlined"},{default:l(()=>[s(Ee,null,{default:l(()=>[Ie]),_:1}),s(Te,null,{default:l(()=>[s(b,{variant:"outlined","prepend-icon":"mdi-arrow-left",onClick:e.returnToSearchPage},{default:l(()=>[c(" Return To Search Page ")]),_:1},8,["onClick"]),s(ge),i("div",Le,g(e.searchResult.length)+" result(s)",1)]),_:1})]),_:1}),s(_e,{justify:"center",class:"pt-10"},{default:l(()=>[s(be,{cols:"12"},{default:l(()=>[e.searchResult.length===0?(u(),x(F,{key:0,type:"info",variant:"tonal",border:"start",class:"mb-6"},{default:l(()=>[c(" No results found. Try a different ligand name or adjust your filters. ")]),_:1})):(u(),x(U,{key:1,variant:"accordion",multiple:""},{default:l(()=>[(u(!0),y(H,null,B(e.groupedByLigand,(r,_)=>(u(),x(j,{key:_},{default:l(()=>[s(w,null,{default:l(()=>[i("div",Be,[i("span",{innerHTML:e.highlightMatch(_),class:"text-h6 mr-3"},null,8,He),s(R,{size:"small",color:"primary",class:"mr-2"},{default:l(()=>[c(g(r.length)+" metal(s) ",1)]),_:2},1024)])]),_:2},1024),s($,null,{default:l(()=>[i("div",Ae,[s(U,{variant:"accordion",multiple:"",modelValue:e.openedMetalPanels,"onUpdate:modelValue":[a[0]||(a[0]=d=>e.openedMetalPanels=d),d=>e.onMetalPanelUpdate(r,d)]},{default:l(()=>[(u(!0),y(H,null,B(e.groupMetalsByLigand(r),(d,v,M)=>(u(),x(j,{key:v,value:M},{default:l(()=>[s(w,null,{default:l(()=>[i("div",ze,[i("span",Fe,[c(g(d[0].central_element),1),i("sup",{innerHTML:e.formatCharge(d[0].metal_charge)},null,8,Ue)]),s(R,{size:"small",color:"secondary",class:"mr-2"},{default:l(()=>[c(g(d.length)+" entry/entries ",1)]),_:2},1024),d[0].formula_string?(u(),x(R,{key:0,size:"small",color:"info"},{default:l(()=>[i("div",{class:"no-katex-html",innerHTML:e.getFormattedMetalForm(d[0].formula_string)},null,8,je)]),_:2},1024)):A("",!0)])]),_:2},1024),s($,null,{default:l(()=>[e.loadingConstants[v]?(u(),y("div",Ne,[s(z,{indeterminate:"",color:"primary"}),Qe])):e.constantsData[v]?e.constantsData[v]&&e.constantsData[v].length>0?(u(),y("div",Xe,[s(ye,{headers:e.constantHeaders,items:e.constantsData[v],"items-per-page":20,class:"elevation-1"},{"item.expression_string":l(({item:o})=>[i("div",{innerHTML:o.expression_string||"-"},null,8,Ye)]),"item.constant_kind":l(({item:o})=>[c(g(o.constant_kind||"-"),1)]),"item.temperature":l(({item:o})=>[c(g(o.temperature!==void 0?o.temperature+(o.temperature_varies?" (varies)":""):"-"),1)]),"item.ionic_strength":l(({item:o})=>[c(g(o.ionic_strength!==void 0?o.ionic_strength:"-"),1)]),"item.value":l(({item:o})=>[c(g(o.value!==void 0?e.formatValue(o.value,o.significant_figures):"-"),1)]),"item.data-table-expand":l(({item:o})=>[s(b,{size:"small",variant:"text",onClick:h=>e.goToDetailPage(d[0])},{default:l(()=>[c(" View Details ")]),_:2},1032,["onClick"])]),_:2},1032,["headers","items"]),i("div",Ze,[s(b,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(d[0])},{default:l(()=>[c(" View Full Details ")]),_:2},1032,["onClick"])])])):e.constantsData[v]&&e.constantsData[v].length===0?(u(),y("div",qe,[s(F,{type:"info",variant:"tonal"},{default:l(()=>[c(" No constants data available for this metal-ligand combination. ")]),_:1}),i("div",Je,[s(b,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(d[0])},{default:l(()=>[c(" View Detail Page ")]),_:2},1032,["onClick"])])])):A("",!0):(u(),y("div",Oe,[s(z,{indeterminate:"",color:"primary"}),We]))]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}const la=he(we,[["render",Ke]]);export{la as default};
