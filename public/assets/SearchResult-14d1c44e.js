import{g as Z,s as $}from"./searchResultStore-303d8faa.js";import{p as S,W as T,X as J,Y as z,h as G,k as E,Z as K,s as ee,$ as y,a0 as F,a1 as C,C as D,a,a2 as N,a3 as Q,a4 as ae,a5 as j,a6 as te,a7 as O,a8 as w,a9 as ne,aa as U,ab as se,ac as W,ad as le,ae as oe,f as ie,af as re,ag as de,v as ce,ah as ue,d as pe,R as ve,_ as he,o as c,c as V,w as l,O as k,P as d,ai as fe,N as i,T as f,Q as ge,aj as m,ak as B,al as M,U as me,am as L,an as _e,ao as xe,ap as ye,aq as R,ar as H,as as Ve,at as ke}from"./index-2c9c234b.js";import{M as Ce,k as Pe,E as be}from"./ElementDisplayUtils-cc25b081.js";import{V as Se,a as Te}from"./VCol-5d00c68c.js";import{V as Ee,a as De,b as Me}from"./VCard-c761c7da.js";import{V as A}from"./VAlert-3386bb7c.js";const P=Symbol.for("vuetify:v-expansion-panel"),Le=["default","accordion","inset","popout"],Re=S({color:String,static:Boolean,variant:{type:String,default:"default",validator:e=>Le.includes(e)},readonly:Boolean,...T(),...J(),...z(),...G()},"VExpansionPanels"),Ie=E()({name:"VExpansionPanels",props:Re(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:n}=t;K(e,P);const{themeClasses:s}=ee(e),u=y(()=>e.variant&&`v-expansion-panels--variant-${e.variant}`);return F({VExpansionPanel:{color:C(e,"color"),readonly:C(e,"readonly"),static:C(e,"static")}}),D(()=>a(e.tag,{class:["v-expansion-panels",s.value,u.value,e.class],style:e.style},n)),{}}}),$e=S({...T(),...N()},"VExpansionPanelText"),q=E()({name:"VExpansionPanelText",props:$e(),setup(e,t){let{slots:n}=t;const s=Q(P);if(!s)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:u,onAfterLeave:x}=ae(e,s.isSelected);return D(()=>a(O,{onAfterLeave:x},{default:()=>{var v;return[j(a("div",{class:["v-expansion-panel-text",e.class],style:e.style},[n.default&&u.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(v=n.default)==null?void 0:v.call(n)])]),[[te,s.isSelected.value]])]}})),{}}}),X=S({color:String,expandIcon:{type:w,default:"$expand"},collapseIcon:{type:w,default:"$collapse"},hideActions:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...T()},"VExpansionPanelTitle"),Y=E()({name:"VExpansionPanelTitle",directives:{Ripple:ne},props:X(),setup(e,t){let{slots:n}=t;const s=Q(P);if(!s)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:u,backgroundColorStyles:x}=U(e,"color"),v=y(()=>({collapseIcon:e.collapseIcon,disabled:s.disabled.value,expanded:s.isSelected.value,expandIcon:e.expandIcon,readonly:e.readonly}));return D(()=>{var _;return j(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":s.isSelected.value,"v-expansion-panel-title--static":e.static},u.value,e.class],style:[x.value,e.style],type:"button",tabindex:s.disabled.value?-1:void 0,disabled:s.disabled.value,"aria-expanded":s.isSelected.value,onClick:e.readonly?void 0:s.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(_=n.default)==null?void 0:_.call(n,v.value),!e.hideActions&&a("span",{class:"v-expansion-panel-title__icon"},[n.actions?n.actions(v.value):a(W,{icon:s.isSelected.value?e.collapseIcon:e.expandIcon},null)])]),[[se("ripple"),e.ripple]])}),{}}}),we=S({title:String,text:String,bgColor:String,...T(),...le(),...oe(),...N(),...ie(),...z(),...X()},"VExpansionPanel"),Be=E()({name:"VExpansionPanel",props:we(),emits:{"group:selected":e=>!0},setup(e,t){let{slots:n}=t;const s=re(e,P),{backgroundColorClasses:u,backgroundColorStyles:x}=U(e,"bgColor"),{elevationClasses:v}=de(e),{roundedClasses:_}=ce(e),h=y(()=>(s==null?void 0:s.disabled.value)||e.disabled),r=y(()=>s.group.items.value.reduce((g,p,b)=>(s.group.selected.value.includes(p.id)&&g.push(b),g),[])),o=y(()=>{const g=s.group.items.value.findIndex(p=>p.id===s.id);return!s.isSelected.value&&r.value.some(p=>p-g===1)}),I=y(()=>{const g=s.group.items.value.findIndex(p=>p.id===s.id);return!s.isSelected.value&&r.value.some(p=>p-g===-1)});return ue(P,s),F({VExpansionPanelText:{eager:C(e,"eager")},VExpansionPanelTitle:{readonly:C(e,"readonly")}}),D(()=>{const g=!!(n.text||e.text),p=!!(n.title||e.title);return a(e.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":s.isSelected.value,"v-expansion-panel--before-active":o.value,"v-expansion-panel--after-active":I.value,"v-expansion-panel--disabled":h.value},_.value,u.value,e.class],style:[x.value,e.style]},{default:()=>{var b;return[a("div",{class:["v-expansion-panel__shadow",...v.value]},null),p&&a(Y,{key:"title",collapseIcon:e.collapseIcon,color:e.color,expandIcon:e.expandIcon,hideActions:e.hideActions,ripple:e.ripple},{default:()=>[n.title?n.title():e.title]}),g&&a(q,{key:"text"},{default:()=>[n.text?n.text():e.text]}),(b=n.default)==null?void 0:b.call(n)]}})}),{}}}),He=pe({name:"SearchResult",setup:()=>{ve({title:"Search Results"})},data:()=>({searchResult:[],lastQuery:"",constantsData:{},loadingConstants:{},openedMetalKeys:[],constantHeaders:[{title:"Expression",align:"start",key:"expression_string"},{title:"Constant Kind",align:"end",key:"constant_kind"},{title:"Temp (Â°C)",align:"end",key:"temperature"},{title:"Ionic Strength (M)",align:"center",key:"ionic_strength"},{title:"Value",align:"start",key:"value"},{title:"Actions",key:"data-table-expand"}]}),computed:{groupedByLigand(){const e={};for(const t of this.searchResult)e[t.name]||(e[t.name]=[]),e[t.name].push(t);return e}},methods:{returnToSearchPage(){this.$router.go(-1)},groupMetalsByLigand(e){const t={};for(const n of e){const s=`${n.central_element}_${n.metal_id}_${n.ligand_id}`;t[s]||(t[s]=[]),t[s].push(n)}return t},toggleMetalPanel(e){const t=this.openedMetalKeys.indexOf(e);if(t>-1)this.openedMetalKeys.splice(t,1);else{this.openedMetalKeys.push(e);const n=this.groupedByLigand;for(const s in n){const u=this.groupMetalsByLigand(n[s]);if(u[e]&&u[e].length>0){!this.constantsData[e]&&!this.loadingConstants[e]&&this.loadConstants(u[e][0]);break}}}},async loadConstants(e){const t=`${e.central_element}_${e.metal_id}_${e.ligand_id}`;if(!this.constantsData[t]){this.loadingConstants[t]=!0;try{const n=await Z(e.ligand_id,e.metal_id);n?this.constantsData[t]=n:this.constantsData[t]=[]}catch(n){console.error("Error loading constants:",n),this.constantsData[t]=[]}finally{this.loadingConstants[t]=!1}}},goToDetailPage(e){const t=$();t.selectedSearchResult=e,this.$router.push("/detail-view")},getFormattedMetalForm(e){if(!e)return"-";const t=Ce.formatMetalFormulaString(e);return Pe.renderToString(t,{displayMode:!1,throwOnError:!1})},formatCharge(e){return be.formatElementCharge(+e)},formatValue(e,t){return t!==void 0?e.toPrecision(t):e.toString()},highlightMatch(e){if(!this.lastQuery)return e;const t=new RegExp(`(${this.lastQuery})`,"ig");return e.replace(t,'<span class="mark">$1</span>')}},mounted(){const e=$();this.searchResult=e.searchResult,this.lastQuery=e.lastQuery}});const Ae=i("div",null,[i("div",{class:"d-flex text-overline mb-1"}," OVERVIEW "),i("div",{class:"d-flex text-h6 mb-1"}," Search Result "),i("div",{class:"d-flex text-caption text-left"}," Here you can view the current search results organized by ligand and metal. Expand each accordion to see the available data tables. ")],-1),ze={class:"text-caption mr-3"},Fe={class:"d-flex align-center"},Ne=["innerHTML"],Qe={class:"pa-2"},je={class:"d-flex align-center"},Oe={class:"text-subtitle-1 mr-3"},Ue=["innerHTML"],We=["innerHTML"],qe={key:0,class:"pa-4"},Xe={key:0,class:"text-center pa-4"},Ye=i("div",{class:"mt-2"},"Loading constants...",-1),Ze={key:1,class:"text-center pa-4"},Je=i("div",{class:"mt-2"},"Loading constants...",-1),Ge={key:2},Ke=["innerHTML"],ea={class:"mt-3"},aa={key:3,class:"text-center pa-4"},ta={class:"mt-3"};function na(e,t,n,s,u,x){return c(),V(Se,{class:"fill-height"},{default:l(()=>[a(me,{class:"d-flex text-center fill-height"},{default:l(()=>[a(Ee,{class:"mx-auto",variant:"outlined"},{default:l(()=>[a(De,null,{default:l(()=>[Ae]),_:1}),a(Me,null,{default:l(()=>[a(k,{variant:"outlined","prepend-icon":"mdi-arrow-left",onClick:e.returnToSearchPage},{default:l(()=>[d(" Return To Search Page ")]),_:1},8,["onClick"]),a(fe),i("div",ze,f(e.searchResult.length)+" result(s)",1)]),_:1})]),_:1}),a(ge,{justify:"center",class:"pt-10"},{default:l(()=>[a(Te,{cols:"12"},{default:l(()=>[e.searchResult.length===0?(c(),V(A,{key:0,type:"info",variant:"tonal",border:"start",class:"mb-6"},{default:l(()=>[d(" No results found. Try a different ligand name or adjust your filters. ")]),_:1})):(c(),V(Ie,{key:1,variant:"accordion",multiple:""},{default:l(()=>[(c(!0),m(M,null,B(e.groupedByLigand,(v,_)=>(c(),V(Be,{key:_},{default:l(()=>[a(Y,null,{default:l(()=>[i("div",Fe,[i("span",{innerHTML:e.highlightMatch(_),class:"text-h6 mr-3"},null,8,Ne),a(L,{size:"small",color:"primary",class:"mr-2"},{default:l(()=>[d(f(v.length)+" metal(s) ",1)]),_:2},1024)])]),_:2},1024),a(q,null,{default:l(()=>[i("div",Qe,[a(_e,null,{default:l(()=>[(c(!0),m(M,null,B(e.groupMetalsByLigand(v),(h,r)=>(c(),m(M,{key:r},[a(xe,null,{prepend:l(()=>[a(k,{icon:"",variant:"text",size:"small",onClick:o=>e.toggleMetalPanel(r)},{default:l(()=>[a(W,null,{default:l(()=>[d(f(e.openedMetalKeys.includes(r)?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:2},1024)]),_:2},1032,["onClick"])]),default:l(()=>[a(ye,null,{default:l(()=>[i("div",je,[i("span",Oe,[d(f(h[0].central_element),1),i("sup",{innerHTML:e.formatCharge(h[0].metal_charge)},null,8,Ue)]),a(L,{size:"small",color:"secondary",class:"mr-2"},{default:l(()=>[d(f(h.length)+" entry/entries ",1)]),_:2},1024),h[0].formula_string?(c(),V(L,{key:0,size:"small",color:"info"},{default:l(()=>[i("div",{class:"no-katex-html",innerHTML:e.getFormattedMetalForm(h[0].formula_string)},null,8,We)]),_:2},1024)):R("",!0)])]),_:2},1024)]),_:2},1024),a(O,null,{default:l(()=>[e.openedMetalKeys.includes(r)?(c(),m("div",qe,[e.loadingConstants[r]?(c(),m("div",Xe,[a(H,{indeterminate:"",color:"primary"}),Ye])):e.constantsData[r]?e.constantsData[r]&&e.constantsData[r].length>0?(c(),m("div",Ge,[a(Ve,{headers:e.constantHeaders,items:e.constantsData[r],"items-per-page":20,class:"elevation-1"},{"item.expression_string":l(({item:o})=>[i("div",{innerHTML:o.expression_string||"-"},null,8,Ke)]),"item.constant_kind":l(({item:o})=>[d(f(o.constant_kind||"-"),1)]),"item.temperature":l(({item:o})=>[d(f(o.temperature!==void 0?o.temperature+(o.temperature_varies?" (varies)":""):"-"),1)]),"item.ionic_strength":l(({item:o})=>[d(f(o.ionic_strength!==void 0?o.ionic_strength:"-"),1)]),"item.value":l(({item:o})=>[d(f(o.value!==void 0?e.formatValue(o.value,o.significant_figures):"-"),1)]),"item.data-table-expand":l(({item:o})=>[a(k,{size:"small",variant:"text",onClick:I=>e.goToDetailPage(h[0])},{default:l(()=>[d(" View Details ")]),_:2},1032,["onClick"])]),_:2},1032,["headers","items"]),i("div",ea,[a(k,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(h[0])},{default:l(()=>[d(" View Full Details ")]),_:2},1032,["onClick"])])])):e.constantsData[r]&&e.constantsData[r].length===0?(c(),m("div",aa,[a(A,{type:"info",variant:"tonal"},{default:l(()=>[d(" No constants data available for this metal-ligand combination. ")]),_:1}),i("div",ta,[a(k,{color:"primary","prepend-icon":"mdi-share",onClick:o=>e.goToDetailPage(h[0])},{default:l(()=>[d(" View Detail Page ")]),_:2},1032,["onClick"])])])):R("",!0):(c(),m("div",Ze,[a(H,{indeterminate:"",color:"primary"}),Je]))])):R("",!0)]),_:2},1024),a(ke,{class:"my-2"})],64))),128))]),_:2},1024)])]),_:2},1024)]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}const ca=he(He,[["render",na]]);export{ca as default};
