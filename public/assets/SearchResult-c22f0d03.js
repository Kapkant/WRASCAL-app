import{s as d}from"./searchResultStore-b0307b0a.js";import{d as _,R as k,_ as w,o as u,c as m,w as r,a as n,O as i,P as l,W as v,N as o,T as h,X as C,Q as M,Y as P,Z as S,$ as T,U as V}from"./index-e3d158ab.js";import{M as R,k as p,P as b}from"./ProtonationDisplayUtil-b764c404.js";import{V as $,a as L}from"./VCol-3fb92d40.js";import{V as F,a as x,b as B}from"./VCard-97199574.js";import{V as H}from"./VAlert-fa374f52.js";const g={name:"Name",form:"Protonation Level",central_element:"Metal",metal_charge:"Metal Charge",formula_string:"Formula String"},D=_({name:"SearchResult",setup:()=>{k({title:"Search Results"})},data:()=>({itemsPerPage:50,pageSizeOptions:[10,25,50,100],headers:[{title:"Actions",key:"actions",sortable:!1},{title:"Name",align:"start",key:"name"},{title:"Protonation Level",align:"end",key:"form"},{title:"Metal Charge",align:"end",key:"metal_charge"},{title:"Formula String",align:"end",key:"formula_string"}],searchResult:[],groupBy:[],groupKeys:[],lastQuery:"",activeMetalFilter:""}),methods:{returnToSearchPage(){this.$router.go(-1)},regroup(){const e=[];for(const t of this.groupKeys)t.isChecked&&e.push({key:t.key});this.groupBy=e},goToDetailPage(e){const t=d();t.selectedSearchResult=e,this.$router.push("/detail-view")},openDetailInNewTab(e){const t=`${window.location.origin}/#/detail-view`,c=d();c.selectedSearchResult=e,window.open(t,"_blank")},async copyLink(e){const t=`${window.location.origin}/#/detail-view`;try{await navigator.clipboard.writeText(t)}catch{}},getFormattedMetalForm(e){if(!e)return"-";const t=R.formatMetalFormulaString(e);return p.renderToString(t,{displayMode:!0,throwOnError:!1})},getFormattedProtonationForm(e){if(!e)return"-";const t=b.formatProtonationString(e);return p.renderToString(t,{displayMode:!0,throwOnError:!1})},highlightMatch(e){if(!this.lastQuery)return e;const t=new RegExp(`(${this.lastQuery})`,"ig");return e.replace(t,'<span class="mark">$1</span>')},filterByMetal(e){this.activeMetalFilter=e;const t=d();this.searchResult=t.searchResult.filter(c=>c.central_element===e)}},mounted(){const e=d();this.searchResult=e.searchResult,this.groupBy=[{key:"name"},{key:"central_element"}],this.groupKeys=[];for(const t of e.getKeys)g[t]!==void 0&&this.groupKeys.push({key:t,name:g[t],isChecked:t==="name"||t==="central_element"});this.lastQuery=e.lastQuery}});const N=o("div",null,[o("div",{class:"d-flex text-overline mb-1"}," OVERVIEW "),o("div",{class:"d-flex text-h6 mb-1"}," Search Result "),o("div",{class:"d-flex text-caption text-left"}," Here you can view the current search results and click on one of the entries to go to the details page for that compound. Clicking on the title in the table header will sort the items in ascending/descending order by that column. Click on the drop-down boxes and buttons at the bottom to control the content displayed on each page and switch between pages. ")],-1),O={class:"text-caption mr-3"},K={class:"text-left"},Q=["colspan"],E=["innerHTML"],U=["innerHTML"],z=["innerHTML"],I=["innerHTML"],A=["innerHTML"];function j(e,t,c,W,X,Y){return u(),m($,{class:"fill-height"},{default:r(()=>[n(V,{class:"d-flex text-center fill-height"},{default:r(()=>[n(F,{class:"mx-auto",variant:"outlined"},{default:r(()=>[n(x,null,{default:r(()=>[N]),_:1}),n(B,null,{default:r(()=>[n(i,{variant:"outlined","prepend-icon":"mdi-arrow-left",onClick:e.returnToSearchPage},{default:r(()=>[l(" Return To Search Page ")]),_:1},8,["onClick"]),n(v),o("div",O,h(e.searchResult.length)+" result(s)",1),n(C,{items:e.pageSizeOptions,modelValue:e.itemsPerPage,"onUpdate:modelValue":t[0]||(t[0]=a=>e.itemsPerPage=a),label:"Rows per page",density:"compact",style:{"max-width":"160px"}},null,8,["items","modelValue"])]),_:1})]),_:1}),n(M,{justify:"center",class:"pt-10"},{default:r(()=>[n(L,{cols:"12"},{default:r(()=>[e.searchResult.length===0?(u(),m(H,{key:0,type:"info",variant:"tonal",border:"start",class:"mb-6"},{default:r(()=>[l(" No results found. Try a different ligand name or adjust your filters. ")]),_:1})):(u(),m(P,{key:1,"items-per-page":e.itemsPerPage,"onUpdate:itemsPerPage":t[1]||(t[1]=a=>e.itemsPerPage=a),"group-by":e.groupBy,headers:e.headers,items:e.searchResult,"item-value":"name",class:"elevation-1"},{"group-header":r(({item:a,columns:s,toggleGroup:f,isGroupOpen:y})=>[o("tr",K,[o("td",{colspan:s.length},[n(i,{size:"small",variant:"text",class:S(`ml-${a.depth*5}`),icon:y(a)?"$expand":"$next",onClick:Z=>f(a)},null,8,["class","icon","onClick"]),o("span",{innerHTML:a.value},null,8,E)],8,Q)])]),"item.actions":r(({item:a})=>[n(i,{rounded:"pill",color:"primary","prepend-icon":"mdi-share",onClick:s=>e.goToDetailPage(a.raw)},{default:r(()=>[l(" Detail ")]),_:2},1032,["onClick"]),n(i,{class:"ml-2",rounded:"pill",color:"secondary","prepend-icon":"mdi-open-in-new",onClick:s=>e.openDetailInNewTab(a.raw)},{default:r(()=>[l(" Open ")]),_:2},1032,["onClick"]),n(i,{class:"ml-2",rounded:"pill",color:"tertiary","prepend-icon":"mdi-content-copy",onClick:s=>e.copyLink(a.raw)},{default:r(()=>[l(" Copy Link ")]),_:2},1032,["onClick"])]),"item.name":r(({item:a})=>[o("span",{innerHTML:e.highlightMatch(a.raw.name)},null,8,U)]),"item.molecular_formula":r(({item:a})=>[o("div",{innerHTML:a.raw.molecular_formula},null,8,z)]),"item.form":r(({item:a})=>[o("div",{class:"no-katex-html",innerHTML:e.getFormattedProtonationForm(a.raw.form)},null,8,I)]),"item.metal_charge":r(({item:a})=>[n(T,{class:"ma-1",color:"blue",onClick:s=>e.filterByMetal(a.raw.central_element)},{default:r(()=>[l(h(a.raw.metal_charge>0?`+${a.raw.metal_charge}`:a.raw.metal_charge),1)]),_:2},1032,["onClick"])]),"item.formula_string":r(({item:a})=>[o("div",{class:"no-katex-html",innerHTML:e.getFormattedMetalForm(a.raw.formula_string)},null,8,A)]),_:2},1032,["items-per-page","group-by","headers","items"]))]),_:1})]),_:1})]),_:1})]),_:1})}const re=w(D,[["render",j]]);export{re as default};
